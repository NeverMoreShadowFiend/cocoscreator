{"version":3,"sources":["main.js"],"names":["cc","Class","extends","Component","properties","pause","Button","progresspower","default","type","ProgressBar","bartime","btnSprite","SpriteFrame","tooltip","bomb","Node","gameMusic","AudioSource","useBombClip","AudioClip","enemyGroup","require","prefabenemyGroup","hero","ufoGroup","bulletGroup","scoreDisplay","Label","bombNoDisplay","close","select","select_bk","onLoad","onSelect_Hero","node","on","event","active","beginGame","that","init","score","progressnum","bombNo","deltatime","testime","bulletname","progress","string","eState","D","commonInfo","gameState","start","starttouchpos","enemyIndex","freqTimeIndex","startAction","bombOnclick","changefreqTimeIndex","console","log","bind","schedule","changeEnemyIndex","unschedule","play","EventType","TOUCH_START","touchcallback","getLocation","TOUCH_MOVE","movecallback","touchpos","dirsx","x","dirsy","y","nodepos","getPosition","setpos","p","minX","width","maxX","minY","height","maxY","setPosition","bombNoLabel","getChildByName","getComponent","parseInt","removeEnemy","audioEngine","playEffect","pauseClick","resumeAction","pauseAction","onDrag","resume","normalSprite","pressedSprite","hoverSprite","offDrag","gainScore","scoreno","toString","getScore","setPowerProgressBar","per","update","delta","changeBullet","updateScore","currentScore","scoreData","common","timeFmt","Date","preData","sys","localStorage","getItem","preTopScore","setItem","unshift","JSON","parse","Array","stringify","killAllEnemy","getUfoBomb","gameOver","director","loadScene","onExit","stop","setProgressCallBack","customEventData","index","target_node","pos","curHeroNode","Sprite","spriteFrame","loader","loadRes","err","hero_index","onUnlock_Hero","onSkillMaxBigen"],"mappings":"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","file":"main.js","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["\ncc.Class({\n    \n    extends: cc.Component,\n\n    properties:()=>({\n        pause: cc.Button,\n        progresspower:{\n            default:null,\n            type : cc.ProgressBar,\n        },\n        bartime : 0,\n        btnSprite: {\n            default: [],\n            type: cc.SpriteFrame,\n            tooltip:'暂停按钮不同状态的图片',\n        },\n        bomb: cc.Node,\n        gameMusic: {\n            default: null,\n            type: cc.AudioSource\n        },\n        useBombClip: cc.AudioClip,\n        enemyGroup: {\n            default: null,\n            type: require('enemyGroup'),\n        },\n        prefabenemyGroup:{\n            default:null,\n            type: require('prefabenemyGroup'),\n        },\n        hero: {\n            default: null,\n            type: require('hero'),\n        }, \n        ufoGroup: {\n            default: null,\n            type: require('ufoGroup'),\n        },\n        bulletGroup: {\n            default: null,\n            type: require('bulletGroup'),\n        },\n        scoreDisplay:cc.Label,\n        bombNoDisplay:cc.Label,\n        \n        close: cc.Button,\n        select: cc.Node,\n        select_bk: cc.Node,\n    }),\n    \n    // use this for initialization\n    onLoad: function () {\n        this.onSelect_Hero(null,1);\n        this.close.node.on('click', function (event) {\n            this.select.active = false;\n            this.select_bk.active = false;\n            this.close.node.active = false;\n            this.beginGame();\n        }, this);\n        //this.beginGame();\n    },\n    \n    //开始游戏\n    beginGame: function(){\n        var that = this;//this的值是随时变化的。\n        this.hero.init();\n        this.score = 0;\n        this.progressnum=0;\n        this.bombNo = 0;\n        this.deltatime=0;\n        this.testime = 0;\n        this.bulletname='ufoBullet';\n        this.progresspower.progress=this.progressnum;\n        this.scoreDisplay.string = this.score;\n        this.bombNoDisplay.string = this.bombNo;\n        this.eState = D.commonInfo.gameState.start;\n        this.starttouchpos =null;\n        this.enemyIndex = 0;\n        this.freqTimeIndex = 0;\n        this.enemyGroup.startAction(this.enemyIndex,this.freqTimeIndex,false);\n        this.bulletGroup.startAction();\n        this.ufoGroup.startAction();\n        //console.log('adfjalsdfjadfja;ldfkja;ldfkja;dklfja;sldfj');\n         //this.prefabenemyGroup.startAction();\n        this.bomb.on('touchstart',this.bombOnclick,this);\n       // var changefreqTimeIndex ='callbackindex20';\n        that.changefreqTimeIndex = function(){\n            that.freqTimeIndex+=1;\n            if(that.freqTimeIndex>5){\n            that.enemyGroup.startAction(this.enemyIndex,this.freqTimeIndex,true);\n            console.log(this.enemyIndex,this.freqTimeIndex);\n        }\n        }.bind(that);\n        this.schedule(that.changefreqTimeIndex,20);\n        \n        // var changeEnemyIndex = 'callbackindex120';\n        this.changeEnemyIndex = function(){\n            that.enemyIndex+=3;\n            if(that.enemyIndex>10){\n            that.enemyIndex=9;\n            }\n            that.unschedule(that.changefreqTimeIndex);\n            that.freqTimeIndex=0;\n            that.schedule(that.changefreqTimeIndex,20);\n            that.enemyGroup.startAction(this.enemyIndex,this.freqTimeIndex,true);\n            console.log(this.enemyIndex,this.freqTimeIndex);\n            }.bind(this);\n\n        this.schedule(this.changeEnemyIndex,120);\n      this.gameMusic.play();\n      // cc.audioEngine.playMusic(\"gema_music.mp3\",true,1);\n       //this.node.addChild(background);\n       this.node.on(cc.Node.EventType.TOUCH_START,this.touchcallback=function(event){that.starttouchpos=event.getLocation();},this);\n        this.node.on(cc.Node.EventType.TOUCH_MOVE,this.movecallback = function(event){ \n            var touchpos = event.getLocation();//获取触摸点坐标\n            var dirsx = touchpos.x-that.starttouchpos.x;//获得移动向量x\n            var dirsy = touchpos.y-that.starttouchpos.y;//获得向量y\n            //var dirs = touchpos - that.starttouchpos;//???为什么不能直接做减法运算 \n            if(that.hero.node!=null)\n            { var nodepos = that.hero.node.getPosition();//获得上一个位置\n            \n                var setpos = cc.p(dirsx*2+nodepos.x,dirsy*2+nodepos.y);\n                that.starttouchpos = touchpos;\n                //需要取得node节点才能利用node节点下的默认方法 \n                //var touchposconv =that.hero.node.parent.convertToNodeSpaceAR(touchpos);//将触摸点转化成父节点的节点坐标\n                var minX = -that.node.width/2;\n                var maxX = -minX;\n                var minY = -that.node.height/2;\n                var maxY = -minY;\n                if (setpos.x< minX){\n                    setpos.x = minX;\n                }\n                if (setpos.x>maxX){\n                    setpos.x = maxX;\n                }\n                if (setpos.y< minY){\n                    setpos.y = minY;\n                }\n                if (setpos.y> maxY){\n                    setpos.y = maxY;\n                }\n                that.hero.node.setPosition(setpos);\n            }//设置飞机的位置},this);//注意设置size}\n           \n        \n        // var backgroundmusic = wx.getBackgroundAudioManager();\n        // backgroundmusic.src = 'assets/sound/game_music.mp3';\n        // backgroundmusic.play();\n        //cc.audioEngine.playMusic('Resources/game_music.mp3',true);\n    //    var listener = {//添加监听事件，屏幕触摸监听\n    //     event: cc.EventListener.TOUCH_ONE_BY_ONE,\n    //     onTouchBegan: function (touches, event) {\n    //         that.starttouchpos = touches.getLocation();\n        \n    //     return true; // 这里必须要写 return true\n    //     },\n    //     onTouchMoved: function (touches, event) {\n    //         var touchpos = touches.getLocation();//获取触摸点坐标\n           \n    //         var dirsx = touchpos.x-that.starttouchpos.x;//获得移动向量x\n    //         var dirsy = touchpos.y-that.starttouchpos.y;//获得向量y\n    //        //var dirs = touchpos - that.starttouchpos;//???为什么不能直接做减法运算 \n    //         var nodepos = that.hero.node.getPosition();//获得上一个位置\n           \n    //         var setpos = cc.p(dirsx*2+nodepos.x,dirsy*2+nodepos.y);\n    //         that.starttouchpos = touchpos;\n    //         //需要取得node节点才能利用node节点下的默认方法 \n    //         //var touchposconv =that.hero.node.parent.convertToNodeSpaceAR(touchpos);//将触摸点转化成父节点的节点坐标\n    //         var minX = -that.node.width/2;\n    //         var maxX = -minX;\n    //         var minY = -that.node.height/2;\n    //         var maxY = -minY;\n    //         if (setpos.x< minX){\n    //             setpos.x = minX;\n    //         }\n    //         if (setpos.x>maxX){\n    //             setpos.x = maxX;\n    //         }\n    //         if (setpos.y< minY){\n    //             setpos.y = minY;\n    //         }\n    //         if (setpos.y> maxY){\n    //             setpos.y = maxY;\n    //         }\n    //         that.hero.node.setPosition(setpos);//设置飞机的位置\n\n    //     },\n    //  }\n    //     cc.eventManager.addListener(listener, this.node); \n      });\n      },\n     \n\n    bombOnclick: function(){\n        var bombNoLabel = this.bomb.getChildByName('bombNo').getComponent(cc.Label);\n        var bombNo = parseInt(bombNoLabel.string);\n       // console.log('bomboncklick on touch ');\n       \n        if (bombNo>0){\n            bombNoLabel.string = bombNo-1;\n            this.removeEnemy();\n            cc.audioEngine.playEffect(this.useBombClip, false);\n        } else {\n            console.log('没有子弹');\n        }\n    },\n    // called every frame, uncomment this function to activate update callback\n    //update: function (dt) {\n        \n    //},\n    \n    //暂停按钮点击事件  \n    pauseClick: function () {//暂停 继续\n    \n        if(this.eState == D.commonInfo.gameState.pause){\n            this.resumeAction();\n           this.eState = D.commonInfo.gameState.start;\n          \n        } else if(this.eState ==D.commonInfo.gameState.start) {\n            this.pauseAction();\n            this.eState = D.commonInfo.gameState.pause;\n            \n        }\n    },\n    //游戏继续\n    resumeAction: function(){\n        this.enemyGroup.resumeAction();\n        this.bulletGroup.resumeAction();\n        this.ufoGroup.resumeAction();\n        this.hero.onDrag();\n        this.gameMusic.resume();\n        this.pause.normalSprite = this.btnSprite[0];\n        this.pause.pressedSprite = this.btnSprite[1];\n        this.pause.hoverSprite = this.btnSprite[1];\n    },\n    //游戏暂停\n    pauseAction: function(){\n        this.enemyGroup.pauseAction();\n            this.bulletGroup.pauseAction();\n            this.hero.offDrag();\n            this.gameMusic.pause();\n            this.ufoGroup.pauseAction();\n            this.pause.normalSprite = this.btnSprite[2];\n            this.pause.pressedSprite = this.btnSprite[3];\n            this.pause.hoverSprite = this.btnSprite[3];\n            \n    },\n    //增加分数\n    gainScore: function (scoreno) {\n        this.score += scoreno;\n        //更新 scoreDisplay Label 的文字\n        this.scoreDisplay.string = this.score.toString();\n    },\n    //get分数\n    getScore: function(){\n        return parseInt(this.scoreDisplay.string);\n    },\n    setPowerProgressBar : function(per){\n      //  console.log(this.progressnum);\n        if(per>5)\n        {per=5;}\n        this.progresspower.progress=per*0.2;\n    },\n    //分数写到本地（ 当前分 最高分 历史记录）\n    update : function(delta){\n            this.deltatime +=delta;\n            this.testime +=delta;\n           // console.log('time++++++++;',this.testime);\n            if(this.deltatime>=10){\n                this.progressnum-=1;\n              //  console.log('this.deltatime progressnum  :  ' +this.deltatime,this.progressnum);\n                this.deltatime=0;\n               \n                if(this.progressnum<=0){\n                this.progressnum=0;\n                 }\n                this.bulletGroup.changeBullet(this.bulletname,this.progressnum);\n            }\n           // console.log('progressnum= '+this.progressnum);\n            this.progresspower.progress-=delta*0.02;\n            if(this.progresspower.progress<0)\n            {\n                this.progresspower.progress= 0;\n            }\n\n    },\n    updateScore: function() {\n        var currentScore = this.scoreDisplay.string;\n        var scoreData = {\n            'score':currentScore,\n            'time': D.common.timeFmt(new Date(),'yyyy-MM-dd hh:mm:ss'),\n        };\n        var preData = cc.sys.localStorage.getItem('score');\n        var preTopScore = cc.sys.localStorage.getItem('topScore');\n        if (!preTopScore || parseInt(preTopScore) < parseInt(currentScore)){\n           cc.sys.localStorage.setItem('topScore', currentScore); \n        }\n        if(!preData){\n            preData = [];\n            preData.unshift(scoreData);\n            \n        } else {\n            preData = JSON.parse(preData);\n\t    if (!(preData instanceof Array)){\n                preData = [];    \n            }\n            preData.unshift(scoreData);\n        }\n        cc.sys.localStorage.setItem('currentScore', currentScore);\n        cc.sys.localStorage.setItem('score', JSON.stringify(preData));\n    },\n    //炸弹清除敌机\n    removeEnemy: function() {\n        this.enemyGroup.killAllEnemy();\n    },\n    //接到炸弹\n    getUfoBomb: function() { \n        if (parseInt(this.bombNoDisplay.string)<3){//多于三个炸弹就不累加\n            this.bombNoDisplay.string += 1;\n        }   \n    },\n    //游戏结束\n    gameOver: function(){ \n        this.pauseAction();\n        this.updateScore();\n       // this.gameMusic.stop();\n        // this.node.off(cc.node.EventType.TOUCH_START,this.touchcallback,this.node);\n        // this.node.off(cc.node.EventType.TOUCH_MOVE,this.movecallback,this.node);\n        cc.director.loadScene('end');\n    },\n    onExit:function(){\n\n        this.gameMusic.stop();\n        this.unschedule(this.setProgressCallBack);\n    },\n\n    onSelect_Hero:function(event, customEventData){\n        var index = customEventData;\n        if (index < 1 || index > 7){\n            return false;\n        }\n        cc.log(\"onSelect_Hero\");\n        var node = this.select_bk.getChildByName(\"select_pic\");\n        var target_node = this.select_bk.getChildByName(\"select_hero\"+index);\n        if(!node){\n            cc.log(\"error select_pic\");\n            return false;\n        }\n        if(!target_node){\n            cc.log(\"error select_hero_\");\n            return false;\n        }\n        var pos = target_node.getPosition();\n        pos.y = pos.y-10;\n        node.setPosition(pos);\n\n        var curHeroNode = this.select_bk.getChildByName(\"cur_hero\");\n        curHeroNode.getComponent(cc.Sprite).spriteFrame = null;\n\n        cc.loader.loadRes(\"Texture/hero\"+index, cc.SpriteFrame, function (err, spriteFrame) {\n            curHeroNode.getComponent(cc.Sprite).spriteFrame = spriteFrame;\n        });\n\n        D.commonInfo.hero_index = index;\n    },\n\n    onUnlock_Hero:function(event){\n        var index = D.commonInfo.hero_index;\n        if (index < 1 || index > 7){\n            return false;\n        }\n        var target_node = this.select_bk.getChildByName(\"select_hero\"+index);\n        target_node.getChildByName(\"mask\").active = false;\n        target_node.getChildByName(\"lock\").active = false;\n    },\n\n    onSkillMaxBigen:function(event){\n        this.select.active = false;\n        this.select_bk.active = false;\n        this.close.node.active = false;\n        this.beginGame();\n        this.progressnum = 5;\n        this.bulletGroup.changeBullet(this.bulletname,this.progressnum);\n        this.setPowerProgressBar(this.progressnum);\n    },\n});\n"]}