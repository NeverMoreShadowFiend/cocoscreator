{"version":3,"sources":["..\\..\\..\\..\\assets\\Script/assets\\Script\\enemyGroup.js"],"names":["enemyG","cc","Class","name","properties","freqTime","default","type","Float","tooltip","initPollCount","prefab","Prefab","extends","Component","main","require","onLoad","eState","D","commonInfo","gameState","none","common","batchInitObjPool","startAction","eindex","tindex","want","start","unscheduleAllCallbacks","enemyindex","ei","fName","e","getNewEnemy","bind","schedule","resumeAction","enabled","pauseAction","pause","enemyInfo","poolName","newNode","genNewNode","node","newV2","getNewEnemyPositon","setPosition","getComponent","init","newEnemy","randx","randomMinus1To1","parent","width","randy","height","v2","enemyDied","nodeinfo","score","backObjPool","parseInt","gainScore","getScore","killAllEnemy","enemys","children","loop","childrenCount","group","onDead"],"mappings":"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","file":"enemyGroup.js","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["\n//敌机组\nvar enemyG = cc.Class({\n    name:'enemyG',\n    properties: {\n        name:'',\n        freqTime : {\n            default:[],\n            type : cc.Float,\n            tooltip:'fuckyou'\n        },\n        initPollCount:0,\n        prefab:cc.Prefab\n    }\n});\n\ncc.Class({\n    extends: cc.Component,\n\n    properties:()=>({\n        enemyG: {\n            default:[],\n            type: enemyG\n        },\n        main: {\n            default: null,\n            type: require('main'),\n        },\n    }),\n    \n    // use this for initialization\n    onLoad: function () { \n        //初始化敌机组\n        this.eState = D.commonInfo.gameState.none;\n        D.common.batchInitObjPool(this,this.enemyG);\n    },\n    startAction: function(eindex,tindex,want){\n        \n        this.eState = D.commonInfo.gameState.start;\n        if(want)\n        {\n            //var emindex = eindex-3;\n            // for(var emindex = eindex-3;emindex<eindex;emindex++){\n            //     var ufName = 'callback_'+emindex;\n            //     this.unschedule(this[ufName]);\n            // }\n            this.unscheduleAllCallbacks();\n        }\n        //定时生成敌机\n        // for (var ei=0; ei< this.enemyG.length; ++ei){\n        //     var freqTime = this.enemyG[ei].freqTime[0];\n        //     var fName = 'callback_'+ei;\n        //     this[fName] = function(e){ this.getNewEnemy(this.enemyG[e]); }.bind(this, ei);\n        //     this.schedule(this[fName], freqTime);\n        // }\n        var enemyindex = eindex+3;\n        for(let ei=eindex;ei<enemyindex;ei++)\n        {\n            var freqTime = this.enemyG[ei].freqTime[tindex];\n            var fName ='callback_'+ei;\n            this[fName] = function(e){this.getNewEnemy(this.enemyG[e]);}.bind(this,ei);\n            this.schedule(this[fName],freqTime);\n        }\n    },\n    //重新开始\n    resumeAction: function(){\n        this.enabled = true;\n        this.eState = D.commonInfo.gameState.start;\n    },\n    //暂停\n    pauseAction: function(){\n        this.enabled = false;\n        this.eState = D.commonInfo.gameState.pause;\n        \n    },\n    //生成敌机\n    getNewEnemy: function(enemyInfo) {\n        var poolName = enemyInfo.name + 'Pool';\n        var newNode = D.common.genNewNode(this[poolName],enemyInfo.prefab,this.node);\n        var newV2 = this.getNewEnemyPositon(newNode);\n        newNode.setPosition(newV2);\n        newNode.getComponent('enemy').init();\n    },\n    //敌机随机生成的位置\n    getNewEnemyPositon: function(newEnemy) {\n        //位于上方，先不可见\n        var randx = cc.randomMinus1To1()*(this.node.parent.width/2-newEnemy.width/2);\n        var randy = this.node.parent.height/2+newEnemy.height/2;\n        return cc.v2(randx,randy);\n    },\n    enemyDied: function(nodeinfo,score){\n        //回收节点\n        D.common.backObjPool(this,nodeinfo);\n        //增加分数\n        if (parseInt(score)>0){\n            this.main.gainScore(score);\n        }  \n    },\n    getScore: function(){\n        return this.main.getScore();\n    },\n\n    killAllEnemy:function(){\n        var enemys = this.node.children;\n        for (let loop = 0; loop < this.node.childrenCount; ++loop) {\n            if(enemys[loop].group == \"enemy\"){\n                enemys[loop].getComponent('enemy').onDead(enemys[loop].name);\n            }\n         }\n    }\n    // called every frame, uncomment this function to activate update callback\n    //update: function (dt) {\n        \n    //},\n    \n});\n"]}