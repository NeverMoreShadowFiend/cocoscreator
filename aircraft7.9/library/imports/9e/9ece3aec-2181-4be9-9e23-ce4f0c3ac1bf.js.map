{"version":3,"sources":["..\\..\\..\\..\\assets\\Script/assets\\Script\\prefabenemyGroup.js"],"names":["prefabenemyG","cc","Class","name","properties","freqTime","initPollCount","prefab","Prefab","extends","Component","default","type","main","require","onLoad","console","log","eState","D","commonInfo","gameState","none","common","batchInitObjPool","startAction","start","ei","length","fName","e","getNewEnemy","bind","schedule","resumeAction","enabled","pauseAction","pause","enemyInfo","poolName","newNode","genNewNode","node","newV2","getNewEnemyPositon","setPosition","index","childrenCount","children","getComponent","init","newEnemy","randx","randomMinus1To1","parent","width","randy","height","v2","enemyDied","nodeinfo","score","backObjPool","parseInt","gainScore","getScore"],"mappings":"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","file":"prefabenemyGroup.js","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["\r\n//敌机组\r\nvar prefabenemyG = cc.Class({\r\n    name:'prefabenemyG',\r\n    properties: {\r\n        name:'',\r\n        freqTime:0,\r\n        initPollCount:0,\r\n        prefab:cc.Prefab\r\n    }\r\n});\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties:()=>({\r\n        prefabenemyG: {\r\n            default:[],\r\n            type: prefabenemyG\r\n        },\r\n        main: {\r\n            default: null,\r\n            type: require('main'),\r\n        },\r\n    }),\r\n    \r\n    // use this for initialization\r\n    onLoad: function () { \r\n        //初始化敌机组\r\n        console.log('-------------');\r\n        this.eState = D.commonInfo.gameState.none;\r\n        D.common.batchInitObjPool(this,this.prefabenemyG);\r\n    },\r\n    startAction: function(){\r\n        console.log('startfunctionjkgkghgkjhgkjgkjhgkjhgkhgkh');\r\n        \r\n        this.eState = D.commonInfo.gameState.start;\r\n        //定时生成敌机\r\n        for (var ei=0; ei< this.prefabenemyG.length; ++ei){\r\n            var freqTime = this.prefabenemyG[ei].freqTime;\r\n            var fName = 'callback_'+ei;\r\n            this[fName] = function(e){ this.getNewEnemy(this.prefabenemyG[e]); }.bind(this, ei);\r\n            this.schedule(this[fName], freqTime);\r\n        }\r\n    },\r\n    //重新开始\r\n    resumeAction: function(){\r\n        this.enabled = true;\r\n        this.eState = D.commonInfo.gameState.start;\r\n    },\r\n    //暂停\r\n    pauseAction: function(){\r\n        this.enabled = false;\r\n        this.eState = D.commonInfo.gameState.pause;\r\n        \r\n    },\r\n    //生成敌机\r\n    getNewEnemy: function(enemyInfo) {\r\n        var poolName = enemyInfo.name + 'Pool';\r\n        var newNode = D.common.genNewNode(this[poolName],enemyInfo.prefab,this.node);\r\n        var newV2 = this.getNewEnemyPositon(newNode);\r\n        newNode.setPosition(newV2);\r\n\r\n        console.log('ffffffffffffffffffffffffffffffffffffffff');\r\n        for(let index=0;index<newNode.childrenCount;index ++){\r\n            console.log('index===================:'+newNode.children[index].name);\r\n            newNode.children[index].getComponent('enemy').init();\r\n        }\r\n       // newNode.getComponent('enemy').init();\r\n    },\r\n    //敌机随机生成的位置\r\n    getNewEnemyPositon: function(newEnemy) {\r\n        //位于上方，先不可见\r\n        var randx = cc.randomMinus1To1()*(this.node.parent.width/2-newEnemy.width/2);\r\n        var randy = this.node.parent.height/2+newEnemy.height/2;\r\n        return cc.v2(randx,randy);\r\n    },\r\n    enemyDied: function(nodeinfo,score){\r\n        //回收节点\r\n        D.common.backObjPool(this,nodeinfo);\r\n        //增加分数\r\n        if (parseInt(score)>0){\r\n            this.main.gainScore(score);\r\n        }  \r\n    },\r\n    getScore: function(){\r\n        return this.main.getScore();\r\n    },\r\n    // called every frame, uncomment this function to activate update callback\r\n    //update: function (dt) {\r\n        \r\n    //},\r\n    \r\n});\r\n"]}