{"version":3,"sources":["..\\..\\..\\..\\assets\\Script/assets\\Script\\bulletGroup.js"],"names":["bPosition","cc","Class","name","properties","xAxis","default","tooltip","yAxis","bulletInfinite","freqTime","initPollCount","prefab","Prefab","position","type","bulletFiniteG","extends","finiteTime","orginName","Component","hero","Node","onLoad","eState","D","commonInfo","gameState","none","common","initObjPool","batchInitObjPool","startAction","start","getNewbullet","bICallback","bind","schedule","pauseAction","enabled","pause","resumeAction","changeBullet","ufoBulletName","index","unschedule","bFCallback","bindex","e","macro","REPEAT_FOREVER","bulletInfo","poolName","bc","length","newNode","genNewNode","node","newV2","getBulletPostion","setPosition","getComponent","bulletGroup","posInfo","hPos","getPosition","newV2_x","x","parseInt","newV2_y","y","p","bulletDied","nodeinfo","backObjPool","bulletStop"],"mappings":"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","file":"bulletGroup.js","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["//子弹生成位置\nvar bPosition = cc.Class({\n    name: 'bPosition',\n    properties: {\n        xAxis: {\n            default:'',\n            tooltip: '初始x轴，相对hero',\n        },\n        yAxis: {\n            default:'',\n            tooltip: '初始y轴，相对hero'\n        },\n    },\n});\n\n//不限时长子弹\nvar bulletInfinite = cc.Class({\n    name:'bulletInfinite',\n    properties: {\n        name:'',\n        freqTime:0,\n        initPollCount:0,\n        prefab:cc.Prefab,\n        position: {\n            default: [],\n            type: bPosition,\n            tooltip: '每次多少排子弹',\n        }\n    }\n});\n\n//有限时长子弹组\nvar bulletFiniteG = cc.Class({\n    name:'bulletFiniteG',\n    extends:bulletInfinite,\n    properties: {\n        finiteTime:0,\n        orginName:'',\n    }\n}); \n\ncc.Class({\n    extends: cc.Component,\n\n    properties:()=> ({\n        bulletInfinite: {\n            default:null,\n            type: bulletInfinite,\n            tooltip:'单束子弹组'\n        },\n        bulletFiniteG: {\n            default:[],\n            type: bulletFiniteG,\n            tooltip:'双束子弹组'\n        },\n        hero: cc.Node,\n    }),\n    \n    // use this for initialization\n    onLoad: function () {\n        this.eState = D.commonInfo.gameState.none;\n        //初始化无限子弹组\n        D.common.initObjPool(this,this.bulletInfinite);\n        //初始化🈶️限子弹组\n        D.common.batchInitObjPool(this,this.bulletFiniteG);\n    },\n    \n    startAction: function(){\n        this.eState = D.commonInfo.gameState.start;\n        //生成子弹\n        this.getNewbullet(this.bulletInfinite);\n        this.bICallback = function(){this.getNewbullet(this.bulletInfinite);}.bind(this);\n        this.schedule(this.bICallback, this.bulletInfinite.freqTime);\n        \n    },\n    pauseAction: function(){\n        this.enabled = false;\n        this.eState = D.commonInfo.gameState.pause;\n    },\n    resumeAction: function(){\n        this.enabled = true;\n        this.eState = D.commonInfo.gameState.start;\n    },\n    //换子弹\n    changeBullet: function(ufoBulletName,index){\n        this.unschedule(this.bICallback);\n        this.unschedule(this.bFCallback);\n       // console.log('ufobulletname:'+ufoBulletName,index);\n       // for (var bi=0; bi<this.bulletFiniteG.length; bi++){\n            if(index>0)\n           {\n                var bindex = index-1;\n                if (this.bulletFiniteG[bindex].orginName == ufoBulletName){\n                this.bFCallback = function(e){this.getNewbullet(this.bulletFiniteG[e]);}.bind(this,bindex);\n                this.schedule(this.bFCallback, this.bulletFiniteG[bindex].freqTime,cc.macro.REPEAT_FOREVER,0.2);\n                // var delay = this.bulletFiniteG[bi].freqTime * this.bulletFiniteG[bi].finiteTime;\n                // this.schedule(this.bICallback,this.bulletInfinite.freqTime,cc.macro.REPEAT_FOREVER,delay);\n                }\n            }else{\n                this.schedule(this.bICallback,this.bulletInfinite.freqTime,cc.macro.REPEAT_FOREVER,0.2);\n            }\n       // }\n    },\n    //生成子弹\n    getNewbullet: function (bulletInfo) {\n        var poolName = bulletInfo.name + 'Pool';\n        for (var bc=0; bc<bulletInfo.position.length; bc++){\n            var newNode = D.common.genNewNode(this[poolName],bulletInfo.prefab,this.node);\n            var newV2 = this.getBulletPostion(bulletInfo.position[bc]);\n            newNode.setPosition(newV2);\n            newNode.getComponent('bullet').bulletGroup = this;\n        }\n    },\n    //获取子弹位置\n    getBulletPostion: function(posInfo){\n        var hPos = this.hero.getPosition();\n        var newV2_x = hPos.x +parseInt(posInfo.xAxis);\n        var newV2_y = hPos.y +parseInt(posInfo.yAxis);\n        return cc.p(newV2_x, newV2_y); \n    },\n\n    //子弹灭亡\n    bulletDied: function(nodeinfo){\n       // console.log('1111111111111111111');\n        D.common.backObjPool(this,nodeinfo);\n    \n    },\n\n\n    //停止子弹\n    bulletStop: function(){\n        this.unschedule(this.bICallback);\n        this.unschedule(this.bFCallback);\n    },\n    \n    // called every frame, uncomment this function to activate update callback\n    // update: function (dt) {\n\n    // },\n});\n"]}