{"version":3,"sources":["main.js"],"names":["cc","Class","extends","Component","properties","pause","Button","progresspower","default","type","ProgressBar","bartime","btnSprite","SpriteFrame","tooltip","bomb","Node","gameMusic","AudioSource","useBombClip","AudioClip","enemyGroup","require","prefabenemyGroup","hero","ufoGroup","bulletGroup","scoreDisplay","Label","bombNoDisplay","onLoad","that","score","progressnum","bombNo","deltatime","testime","bulletname","progress","string","eState","D","commonInfo","gameState","start","starttouchpos","enemyIndex","freqTimeIndex","startAction","on","bombOnclick","changefreqTimeIndex","console","log","bind","schedule","changeEnemyIndex","unschedule","play","node","EventType","TOUCH_START","touchcallback","event","getLocation","TOUCH_MOVE","movecallback","touchpos","dirsx","x","dirsy","y","nodepos","getPosition","setpos","p","minX","width","maxX","minY","height","maxY","setPosition","bombNoLabel","getChildByName","getComponent","parseInt","removeEnemy","audioEngine","playEffect","pauseClick","resumeAction","pauseAction","onDrag","resume","normalSprite","pressedSprite","hoverSprite","offDrag","gainScore","scoreno","toString","getScore","setPowerProgressBar","per","update","delta","changeBullet","updateScore","currentScore","scoreData","common","timeFmt","Date","preData","sys","localStorage","getItem","preTopScore","setItem","unshift","JSON","parse","Array","stringify","removeAllChildren","getUfoBomb","gameOver","director","loadScene","onExit","stop","setProgressCallBack"],"mappings":"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","file":"main.js","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["\ncc.Class({\n    \n    extends: cc.Component,\n\n    properties:()=>({\n        pause: cc.Button,\n        progresspower:{\n            default:null,\n            type : cc.ProgressBar,\n        },\n        bartime : 0,\n        btnSprite: {\n            default: [],\n            type: cc.SpriteFrame,\n            tooltip:'暂停按钮不同状态的图片',\n        },\n        bomb: cc.Node,\n        gameMusic: {\n            default: null,\n            type: cc.AudioSource\n        },\n        useBombClip: cc.AudioClip,\n        enemyGroup: {\n            default: null,\n            type: require('enemyGroup'),\n        },\n        prefabenemyGroup:{\n            default:null,\n            type: require('prefabenemyGroup'),\n        },\n        hero: {\n            default: null,\n            type: require('hero'),\n        }, \n        ufoGroup: {\n            default: null,\n            type: require('ufoGroup'),\n        },\n        bulletGroup: {\n            default: null,\n            type: require('bulletGroup'),\n        },\n        scoreDisplay:cc.Label,\n        bombNoDisplay:cc.Label,\n    }),\n    \n    // use this for initialization\n    onLoad: function () {\n        \n        var that = this;//this的值是随时变化的。\n        this.score = 0;\n        this.progressnum=0;\n        this.bombNo = 0;\n        this.deltatime=0;\n        this.testime = 0;\n        this.bulletname='ufoBullet';\n        this.progresspower.progress=this.progressnum;\n        this.scoreDisplay.string = this.score;\n        this.bombNoDisplay.string = this.bombNo;\n        this.eState = D.commonInfo.gameState.start;\n        this.starttouchpos =null;\n        this.enemyIndex = 0;\n        this.freqTimeIndex = 0;\n        this.enemyGroup.startAction(this.enemyIndex,this.freqTimeIndex,false);\n        this.bulletGroup.startAction();\n        this.ufoGroup.startAction();\n        //console.log('adfjalsdfjadfja;ldfkja;ldfkja;dklfja;sldfj');\n         //this.prefabenemyGroup.startAction();\n        this.bomb.on('touchstart',this.bombOnclick,this);\n        var changefreqTimeIndex ='callbackindex20';\n        that[changefreqTimeIndex] = function(){\n            that.freqTimeIndex+=1;\n            if(that.freqTimeIndex<=5){\n            that.enemyGroup.startAction(this.enemyIndex,this.freqTimeIndex,false);\n            console.log(this.enemyIndex,this.freqTimeIndex);\n        }\n        }.bind(that);\n        this.schedule(that[changefreqTimeIndex],20);\n        \n        var changeEnemyIndex = 'callbackindex120';\n        this[changeEnemyIndex] = function(){\n            that.enemyIndex+=3;\n            if(that.enemyIndex<10){\n                that.unschedule(that[changefreqTimeIndex]);\n                that.freqTimeIndex=0;\n                that.schedule(that[changefreqTimeIndex],20);\n                that.enemyGroup.startAction(this.enemyIndex,this.freqTimeIndex,true);\n                console.log(this.enemyIndex,this.freqTimeIndex);\n            }\n            }.bind(this);\n\n        this.schedule(this[changeEnemyIndex],120);\n      this.gameMusic.play();\n      // cc.audioEngine.playMusic(\"gema_music.mp3\",true,1);\n       //this.node.addChild(background);\n       this.node.on(cc.Node.EventType.TOUCH_START,this.touchcallback=function(event){that.starttouchpos=event.getLocation();},this);\n        this.node.on(cc.Node.EventType.TOUCH_MOVE,this.movecallback = function(event){ \n            var touchpos = event.getLocation();//获取触摸点坐标\n            var dirsx = touchpos.x-that.starttouchpos.x;//获得移动向量x\n            var dirsy = touchpos.y-that.starttouchpos.y;//获得向量y\n            //var dirs = touchpos - that.starttouchpos;//???为什么不能直接做减法运算 \n            if(that.hero.node!=null)\n            { var nodepos = that.hero.node.getPosition();//获得上一个位置\n            \n                var setpos = cc.p(dirsx*2+nodepos.x,dirsy*2+nodepos.y);\n                that.starttouchpos = touchpos;\n                //需要取得node节点才能利用node节点下的默认方法 \n                //var touchposconv =that.hero.node.parent.convertToNodeSpaceAR(touchpos);//将触摸点转化成父节点的节点坐标\n                var minX = -that.node.width/2;\n                var maxX = -minX;\n                var minY = -that.node.height/2;\n                var maxY = -minY;\n                if (setpos.x< minX){\n                    setpos.x = minX;\n                }\n                if (setpos.x>maxX){\n                    setpos.x = maxX;\n                }\n                if (setpos.y< minY){\n                    setpos.y = minY;\n                }\n                if (setpos.y> maxY){\n                    setpos.y = maxY;\n                }\n                that.hero.node.setPosition(setpos);\n            }//设置飞机的位置},this);//注意设置size}\n           \n        \n        // var backgroundmusic = wx.getBackgroundAudioManager();\n        // backgroundmusic.src = 'assets/sound/game_music.mp3';\n        // backgroundmusic.play();\n        //cc.audioEngine.playMusic('Resources/game_music.mp3',true);\n    //    var listener = {//添加监听事件，屏幕触摸监听\n    //     event: cc.EventListener.TOUCH_ONE_BY_ONE,\n    //     onTouchBegan: function (touches, event) {\n    //         that.starttouchpos = touches.getLocation();\n        \n    //     return true; // 这里必须要写 return true\n    //     },\n    //     onTouchMoved: function (touches, event) {\n    //         var touchpos = touches.getLocation();//获取触摸点坐标\n           \n    //         var dirsx = touchpos.x-that.starttouchpos.x;//获得移动向量x\n    //         var dirsy = touchpos.y-that.starttouchpos.y;//获得向量y\n    //        //var dirs = touchpos - that.starttouchpos;//???为什么不能直接做减法运算 \n    //         var nodepos = that.hero.node.getPosition();//获得上一个位置\n           \n    //         var setpos = cc.p(dirsx*2+nodepos.x,dirsy*2+nodepos.y);\n    //         that.starttouchpos = touchpos;\n    //         //需要取得node节点才能利用node节点下的默认方法 \n    //         //var touchposconv =that.hero.node.parent.convertToNodeSpaceAR(touchpos);//将触摸点转化成父节点的节点坐标\n    //         var minX = -that.node.width/2;\n    //         var maxX = -minX;\n    //         var minY = -that.node.height/2;\n    //         var maxY = -minY;\n    //         if (setpos.x< minX){\n    //             setpos.x = minX;\n    //         }\n    //         if (setpos.x>maxX){\n    //             setpos.x = maxX;\n    //         }\n    //         if (setpos.y< minY){\n    //             setpos.y = minY;\n    //         }\n    //         if (setpos.y> maxY){\n    //             setpos.y = maxY;\n    //         }\n    //         that.hero.node.setPosition(setpos);//设置飞机的位置\n\n    //     },\n    //  }\n    //     cc.eventManager.addListener(listener, this.node); \n      });\n      },\n     \n\n    bombOnclick: function(){\n        var bombNoLabel = this.bomb.getChildByName('bombNo').getComponent(cc.Label);\n        var bombNo = parseInt(bombNoLabel.string);\n       // console.log('bomboncklick on touch ');\n        if (bombNo>0){\n            bombNoLabel.string = bombNo-1;\n            this.removeEnemy();\n            cc.audioEngine.playEffect(this.useBombClip, false);\n        } else {\n            console.log('没有子弹');\n        }\n    },\n    // called every frame, uncomment this function to activate update callback\n    //update: function (dt) {\n        \n    //},\n    \n    //暂停按钮点击事件  \n    pauseClick: function () {//暂停 继续\n    \n        if(this.eState == D.commonInfo.gameState.pause){\n            this.resumeAction();\n           this.eState = D.commonInfo.gameState.start;\n          \n        } else if(this.eState ==D.commonInfo.gameState.start) {\n            this.pauseAction();\n            this.eState = D.commonInfo.gameState.pause;\n            \n        }\n    },\n    //游戏继续\n    resumeAction: function(){\n        this.enemyGroup.resumeAction();\n        this.bulletGroup.resumeAction();\n        this.ufoGroup.resumeAction();\n        this.hero.onDrag();\n        this.gameMusic.resume();\n        this.pause.normalSprite = this.btnSprite[0];\n        this.pause.pressedSprite = this.btnSprite[1];\n        this.pause.hoverSprite = this.btnSprite[1];\n    },\n    //游戏暂停\n    pauseAction: function(){\n        this.enemyGroup.pauseAction();\n            this.bulletGroup.pauseAction();\n            this.hero.offDrag();\n            this.gameMusic.pause();\n            this.ufoGroup.pauseAction();\n            this.pause.normalSprite = this.btnSprite[2];\n            this.pause.pressedSprite = this.btnSprite[3];\n            this.pause.hoverSprite = this.btnSprite[3];\n            \n    },\n    //增加分数\n    gainScore: function (scoreno) {\n        this.score += scoreno;\n        //更新 scoreDisplay Label 的文字\n        this.scoreDisplay.string = this.score.toString();\n    },\n    //get分数\n    getScore: function(){\n        return parseInt(this.scoreDisplay.string);\n    },\n    setPowerProgressBar : function(per){\n      //  console.log(this.progressnum);\n        if(per>5)\n        {per=5;}\n        this.progresspower.progress=per*0.2;\n    },\n    //分数写到本地（ 当前分 最高分 历史记录）\n    update : function(delta){\n            this.deltatime +=delta;\n            this.testime +=delta;\n            console.log('time++++++++;',this.testime);\n            if(this.deltatime>=10){\n                this.progressnum-=1;\n              //  console.log('this.deltatime progressnum  :  ' +this.deltatime,this.progressnum);\n                this.deltatime=0;\n               \n                if(this.progressnum<=0){\n                this.progressnum=0;\n                 }\n                this.bulletGroup.changeBullet(this.bulletname,this.progressnum);\n            }\n           // console.log('progressnum= '+this.progressnum);\n            this.progresspower.progress-=delta*0.02;\n            if(this.progresspower.progress<0)\n            {\n                this.progresspower.progress= 0;\n            }\n\n    },\n    updateScore: function() {\n        var currentScore = this.scoreDisplay.string;\n        var scoreData = {\n            'score':currentScore,\n            'time': D.common.timeFmt(new Date(),'yyyy-MM-dd hh:mm:ss'),\n        };\n        var preData = cc.sys.localStorage.getItem('score');\n        var preTopScore = cc.sys.localStorage.getItem('topScore');\n        if (!preTopScore || parseInt(preTopScore) < parseInt(currentScore)){\n           cc.sys.localStorage.setItem('topScore', currentScore); \n        }\n        if(!preData){\n            preData = [];\n            preData.unshift(scoreData);\n            \n        } else {\n            preData = JSON.parse(preData);\n\t    if (!(preData instanceof Array)){\n                preData = [];    \n            }\n            preData.unshift(scoreData);\n        }\n        cc.sys.localStorage.setItem('currentScore', currentScore);\n        cc.sys.localStorage.setItem('score', JSON.stringify(preData));\n    },\n    //炸弹清除敌机\n    removeEnemy: function() {\n        this.enemyGroup.node.removeAllChildren();\n    },\n    //接到炸弹\n    getUfoBomb: function() { \n        if (parseInt(this.bombNoDisplay.string)<3){//多于三个炸弹就不累加\n            this.bombNoDisplay.string += 1;\n        }   \n    },\n    //游戏结束\n    gameOver: function(){ \n        this.pauseAction();\n        this.updateScore();\n       // this.gameMusic.stop();\n        // this.node.off(cc.node.EventType.TOUCH_START,this.touchcallback,this.node);\n        // this.node.off(cc.node.EventType.TOUCH_MOVE,this.movecallback,this.node);\n        cc.director.loadScene('end');\n    },\n    onExit:function(){\n\n        this.gameMusic.stop();\n        this.unschedule(this.setProgressCallBack);\n    },\n});\n"]}